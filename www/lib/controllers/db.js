// Generated by CoffeeScript 1.6.1
(function() {

  module.exports = {
    initialise: function() {
      var _this = this;
      this.db = window.openDatabase("diary", 1, "diary", 1000000);
      return this.db.transaction(function(t) {
        console.log('1');
        return t.executeSql('create table if not exists digits(' + 'id INTEGER PRIMARY KEY AUTOINCREMENT, value TEXT' + ')');
      }, this.onError);
    },
    onError: function(e) {
      return console.log('DB ERROR:', e);
    },
    getAll: function(callback) {
      var _this = this;
      console.log('2');
      return this.db.transaction(function(t) {
        return t.executeSql('select * from digits', [], function(t, results) {
          return callback(_this.fixResults(results));
        }, _this.onError);
      }, this.onError);
    },
    save: function(digits, callback) {
      var _this = this;
      return this.db.transaction(function(t) {
        return t.executeSql('insert into digits(value) values(?)', [digits], function() {
          if (callback) {
            return callback();
          }
        }, _this.onError);
      }, this.onError);
    },
    fixResults: function(res) {
      var i, item, result, row, _i, _len, _ref;
      result = [];
      _ref = res.rows;
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        item = _ref[i];
        row = res.rows.item(i);
        result.push(row);
      }
      return result;
    }
  };

}).call(this);
